<!DOCTYPE html>
<html>

	<head>
		
<title>Android单元测试-Quiet</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/favicon.ico">


<meta name="keywords" content="Android,">
<meta name="description" content="">


<script src="/js/jquery.min.js"></script>


	<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="RiddleGo" type="application/atom+xml">
</head>

	<body>
		
<link rel="stylesheet" href="/css/page.css">


<link rel="stylesheet" href="/css/page_cente.css">


<link rel="stylesheet" href="/css/atom-one-dark.css">


<link rel="stylesheet" href="/css/header.css">

	<div class="header">
		<div class="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/logo.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										HOME
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										ARCHIVE
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										CATEGORIES
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										TAGS
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/links">
										LINKS
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/about">
										ABOUT
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>CHANGEQ</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">HOME</a>
        </li>
        
        <li>
            <a href="/archives">ARCHIVE</a>
        </li>
        
        <li>
            <a href="/categories">CATEGORIES</a>
        </li>
        
        <li>
            <a href="/tags">TAGS</a>
        </li>
        
        <li>
            <a href="/links">LINKS</a>
        </li>
        
        <li>
            <a href="/about">ABOUT</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/qiaobug">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
        </a>
        
    </div>
</div>
<div class='shelter'
    style='cursor: pointer;display: none; position: fixed;left: 0;top: 0; right: 0;bottom: 0;background-color: #333;opacity:0.5;z-index: 108;'>
</div>
<style>
    .sidebar {
        width: 0;
        height: 100%;
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        background: #fff;
        z-index: 999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815)
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $(function () { $('.h-right-close>svg').click(function () { $('.sidebar').animate({ width: "66%" }, 500); $('.shelter').fadeIn("slow") }); $('.shelter').click(function (e) { $('.sidebar').animate({ width: "0" }, 500); $('.shelter').fadeOut("slow") }) })
</script>
		<script>
			$(function () { $(window).scroll(function () { if ($(document).scrollTop() > 100) { $(".header-top").removeClass("header-move2"); $('.header-top').addClass('header-move1') } else { $(".header-top").removeClass("header-move1"); $('.header-top').addClass('header-move2') } }) });
		</script>
<div class="header-bg ">
    <div class="bg-content">
        <ul class="tag">
            
            
            <li><a href="/tags/Android">Android</a></li>
            
            
        </ul>
        <h1>Android单元测试</h1>
        <div class="article-info">
            <div class="article-author">
                
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
                    <g>
                        <path fill="#12183A"
                            d="M6.187 15.265A6.47 6.47 0 0 0 10 16.5a6.47 6.47 0 0 0 3.813-1.235A4.99 4.99 0 0 0 10 13.5a4.99 4.99 0 0 0-3.813 1.765zM5.082 14.25A6.485 6.485 0 0 1 10 12c1.965 0 3.726.872 4.918 2.25a6.5 6.5 0 1 0-9.836 0zM10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-1.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z">
                        </path>
                    </g>
                </svg>
                
                <span> <a href="">CHANGEQ</a></span>
                <p>2021-05-12 18:18:09</p>
            </div>
        </div>
    </div>
</div>
<div class="article-content">
    <div id="article" class="content">
        <h1 id="Android单元测试：JUnit框架的使用"><a href="#Android单元测试：JUnit框架的使用" class="headerlink" title="Android单元测试：JUnit框架的使用"></a>Android单元测试：JUnit框架的使用</h1><p><a target="_blank" rel="noopener" href="https://weilu.blog.csdn.net/article/details/78243176?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.control">本文转自唯鹿</a></p>
<p>边学习  边记笔记</p>
<h3 id="1-1-前言"><a href="#1-1-前言" class="headerlink" title="1 1.前言"></a>1 1.前言</h3><p>网上有许多关于单元测试的好处，这里我就不去说了。我写单元测试的理由很简单粗暴，就是图一个方便。<br>试想一下这个场景：我们在写一个新功能，每写一部分，我们就安装到手机上查看一下，这个过程中你要点击到对应的页面，做对应的操作，最后才能反馈给你结果。如果达到了预期效果，那么恭喜你。可是一旦这次失败了，是不是又要重复这一过程？是不是感到很麻烦？很费时间？如果你想早点写完下班，那么你就需要掌握单元测试。因为它能大大的缩短你自我验证的时间。</p>
<h3 id="2-准备工作"><a href="#2-准备工作" class="headerlink" title="2.准备工作"></a>2.准备工作</h3><p>我们新建一个项目，模板代码会默认在build文件中添加JUnit的依赖，而单元测试代码是放在src/test/java下面的，如下图：</p>
<p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest01.jpg"></p>
<p>用鼠标右键点击测试方法，选择菜单中的“Run”选项就可以执行对应的单元测试。我执行了图中的测试代码，可以看到执行方法只用了6毫秒，整个过程不到2秒。</p>
<h3 id="3-JUnit介绍"><a href="#3-JUnit介绍" class="headerlink" title="3.JUnit介绍"></a>3.JUnit介绍</h3><p>JUnit是Java最基础的测试框架，主要的作用就是断言。</p>
<p>使用时在app的build文件中添加依赖。注意：用于测试环境框架一律是testCompile开头。</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">dependencies</span> &#123;<br>    <span class="hljs-attribute">testCompile</span> <span class="hljs-string">&#x27;junit:junit:4.12&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>Assert类中主要方法如下：</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th align="center">方法描述</th>
</tr>
</thead>
<tbody><tr>
<td>assertEquals</td>
<td align="center">断言传入的预期值与实际值是相等的</td>
</tr>
<tr>
<td>assertNotEquals</td>
<td align="center">断言传入的预期值与实际值是不相等的</td>
</tr>
<tr>
<td>assertArrayEquals</td>
<td align="center">断言传入的预期数组与实际数组是相等的</td>
</tr>
<tr>
<td>assertNull</td>
<td align="center">断言传入的对象是为空</td>
</tr>
<tr>
<td>assertNotNull</td>
<td align="center">断言传入的对象是不为空</td>
</tr>
<tr>
<td>assertTrue</td>
<td align="center">断言条件为真</td>
</tr>
<tr>
<td>assertFalse</td>
<td align="center">断言条件为假</td>
</tr>
<tr>
<td>assertSame</td>
<td align="center">断言两个对象引用同一个对象，相当于“==”</td>
</tr>
<tr>
<td>assertNotSame</td>
<td align="center">断言两个对象引用不同的对象，相当于“!=”</td>
</tr>
<tr>
<td>assertThat</td>
<td align="center">断言实际值是否满足指定的条件</td>
</tr>
</tbody></table>
<p>注意：上面的每一个方法，都有对应的重载方法，可以在前面加一个String类型的参数，表示如果断言失败时的提示。</p>
<p>JUnit 中的常用注解：</p>
<table>
<thead>
<tr>
<th>注解名</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td>@Test</td>
<td align="center">表示此方法为测试方法</td>
</tr>
<tr>
<td>@Before</td>
<td align="center">在每个测试方法前执行，可做初始化操作</td>
</tr>
<tr>
<td>@After</td>
<td align="center">在每个测试方法后执行，可做释放资源操作</td>
</tr>
<tr>
<td>@Ignore</td>
<td align="center">忽略的测试方法</td>
</tr>
<tr>
<td>@BeforeClass</td>
<td align="center">在类中所有方法前运行。此注解修饰的方法必须是static void</td>
</tr>
<tr>
<td>@AfterClass</td>
<td align="center">在类中最后运行。此注解修饰的方法必须是static void</td>
</tr>
<tr>
<td>@RunWith</td>
<td align="center">指定该测试类使用某个运行器</td>
</tr>
<tr>
<td>@Parameters</td>
<td align="center">指定测试类的测试数据集合</td>
</tr>
<tr>
<td>@Rule</td>
<td align="center">重新制定测试类中方法的行为</td>
</tr>
<tr>
<td>@FixMethodOrder</td>
<td align="center">指定测试类中方法的执行顺序</td>
</tr>
<tr>
<td>执行顺序：@BeforeClass –&gt; @Before –&gt; @Test –&gt; @After –&gt; @AfterClass</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="5-JUnit用法"><a href="#5-JUnit用法" class="headerlink" title="5.JUnit用法"></a>5.JUnit用法</h3><p>我们测试下面这个简单的时间转换工具类，来说明一下具体的用法。<br>、、、<br>public class DateUtil {</p>
<pre><code>/**
 * 英文全称  如：2017-11-01 22:11:00
 */
public static String FORMAT_YMDHMS = &quot;yyyy-MM-dd HH:mm:ss&quot;;

/**
 * 掉此方法输入所要转换的时间输入例如（&quot;2017-11-01 22:11:00&quot;）返回时间戳
 *
 * @param time
 * @return 时间戳
 */
public static long dateToStamp(String time) throws ParseException&#123;
    SimpleDateFormat sdr = new SimpleDateFormat(FORMAT_YMDHMS, Locale.CHINA);
    Date date = sdr.parse(time);
    return date.getTime();
&#125;

/**
 * 将时间戳转换为时间
 */
public static String stampToDate(long lt)&#123;
    String res;
    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(FORMAT_YMDHMS, Locale.CHINA);
    Date date = new Date(lt);
    res = simpleDateFormat.format(date);
    return res;
&#125;
</code></pre>
<p>}<br>、、、</p>
<h4 id="1-基础用法"><a href="#1-基础用法" class="headerlink" title="1.基础用法"></a>1.基础用法</h4><h5 id="1-首先测试stampToDate方法，测试时我认为返回的结果等于“预期时间”这个字符串。测试方法执行后如下图："><a href="#1-首先测试stampToDate方法，测试时我认为返回的结果等于“预期时间”这个字符串。测试方法执行后如下图：" class="headerlink" title="1.首先测试stampToDate方法，测试时我认为返回的结果等于“预期时间”这个字符串。测试方法执行后如下图："></a>1.首先测试stampToDate方法，测试时我认为返回的结果等于“预期时间”这个字符串。测试方法执行后如下图：</h5><p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest02.jpg"></p>
<p>可以看到预期值与实际结果不符，测试失败！想要测试成功要么预期值为”2017-10-15 16:00:02”要么使用assertNotEquals方法断言。</p>
<h5 id="2-接下来测试dateToStamp方法。"><a href="#2-接下来测试dateToStamp方法。" class="headerlink" title="2.接下来测试dateToStamp方法。"></a>2.接下来测试dateToStamp方法。</h5><p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest03.jpg"></p>
<p>很简单，我认为返回结果不等于4，结果测试通过。</p>
<h5 id="3-我们注意到在dateToStamp方法中，有抛出一个解析异常-ParseException-。也就是当参数没有按照规定格式去传，就会导致这个异常。"><a href="#3-我们注意到在dateToStamp方法中，有抛出一个解析异常-ParseException-。也就是当参数没有按照规定格式去传，就会导致这个异常。" class="headerlink" title="3.我们注意到在dateToStamp方法中，有抛出一个解析异常(ParseException)。也就是当参数没有按照规定格式去传，就会导致这个异常。"></a>3.我们注意到在dateToStamp方法中，有抛出一个解析异常(ParseException)。也就是当参数没有按照规定格式去传，就会导致这个异常。</h5><p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest04.jpg"></p>
<p>那我们怎么验证一个方法是否抛出了异常呢？可以给@Test注解设置expected参数来实现，如下：</p>
<p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest05.jpg"></p>
<p>抛出了对应的异常则测试成功，反之则测试失败。</p>
<h4 id="2-参数化测试"><a href="#2-参数化测试" class="headerlink" title="2.参数化测试"></a>2.参数化测试</h4><p>这时，你是不是觉得还是很麻烦，因为每次测试一个方法都要去设置对应的值，就不能连续用不不同的值去测试一个方法，省的我们不断地修改。这时就用到了@RunWith与@Parameters。</p>
<p>首先在测试类上添加注解@RunWith(Parameterized.class)，在创建一个由 @Parameters 注解的public static方法，让返回一个对应的测试数据集合。最后创建构造方法，方法的参数顺序和类型与测试数据集合一一对应。</p>
<p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest06.jpg"></p>
<p>上图就是一个简单的例子，可以看到连续执行了三次测试，其中第二次测试没有抛出异常，测试失败！</p>
<h4 id="3-assertThat用法"><a href="#3-assertThat用法" class="headerlink" title="3.assertThat用法"></a>3.assertThat用法</h4><p>上面我们所用到的一些基本的断言，如果我们没有设置失败时的输出信息，那么在断言失败时只会抛出AssertionError，无法知道到底是哪一部分出错。而assertThat就帮我们解决了这一点。它的可读性更好。</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">assert</span><span class="hljs-constructor">That(T <span class="hljs-params">actual</span>, Matcher&lt;? <span class="hljs-params">super</span> T&gt; <span class="hljs-params">matcher</span>)</span>;<br><br><span class="hljs-keyword">assert</span><span class="hljs-constructor">That(String <span class="hljs-params">reason</span>, T <span class="hljs-params">actual</span>, Matcher&lt;? <span class="hljs-params">super</span> T&gt; <span class="hljs-params">matcher</span>)</span>; <br></code></pre></td></tr></table></figure>

<p>其中reason为断言失败时的输出信息，actual为断言的值，matcher为断言的匹配器。</p>
<p>常用的匹配器整理：</p>
<table>
<thead>
<tr>
<th>匹配器</th>
<th align="right">说明</th>
<th>例子</th>
</tr>
</thead>
<tbody><tr>
<td>is</td>
<td align="right">断言参数等于后面给出的匹配表达式</td>
<td>assertThat(5, is (5));</td>
</tr>
<tr>
<td>not</td>
<td align="right">断言参数不等于后面给出的匹配表达式</td>
<td>assertThat(5, not(6));</td>
</tr>
<tr>
<td>equalTo</td>
<td align="right">断言参数相等</td>
<td>assertThat(30, equalTo(30));</td>
</tr>
<tr>
<td>equalToIgnoringCase</td>
<td align="right">断言字符串相等忽略大小写</td>
<td>assertThat(“Ab”, equalToIgnoringCase(“ab”));</td>
</tr>
<tr>
<td>containsString</td>
<td align="right">断言字符串包含某字符串</td>
<td>assertThat(“abc”, containsString(“bc”));</td>
</tr>
<tr>
<td>startsWith</td>
<td align="right">断言字符串以某字符串开始</td>
<td>assertThat(“abc”, startsWith(“a”));</td>
</tr>
<tr>
<td>endsWith</td>
<td align="right">断言字符串以某字符串结束</td>
<td>assertThat(“abc”, endsWith(“c”));</td>
</tr>
<tr>
<td>nullValue</td>
<td align="right">断言参数的值为null</td>
<td>assertThat(null, nullValue());</td>
</tr>
<tr>
<td>notNullValue</td>
<td align="right">断言参数的值不为null</td>
<td>assertThat(“abc”, notNullValue());</td>
</tr>
<tr>
<td>greaterThan</td>
<td align="right">断言参数大于</td>
<td>assertThat(4, greaterThan(3));</td>
</tr>
<tr>
<td>lessThan</td>
<td align="right">断言参数小于</td>
<td>assertThat(4, lessThan(6));</td>
</tr>
<tr>
<td>greaterThanOrEqualTo</td>
<td align="right">断言参数大于等于</td>
<td>assertThat(4, greaterThanOrEqualTo(3));</td>
</tr>
<tr>
<td>lessThanOrEqualTo</td>
<td align="right">断言参数小于等于</td>
<td>assertThat(4, lessThanOrEqualTo(6));</td>
</tr>
<tr>
<td>closeTo</td>
<td align="right">断言浮点型数在某一范围内</td>
<td>assertThat(4.0, closeTo(2.6, 4.3));</td>
</tr>
<tr>
<td>allOf</td>
<td align="right">断言符合所有条件，相当于&amp;&amp;</td>
<td>assertThat(4,allOf(greaterThan(3), lessThan(6)));</td>
</tr>
<tr>
<td>anyOf</td>
<td align="right">断言符合某一条件，相当于或</td>
<td>assertThat(4,anyOf(greaterThan(9), lessThan(6)));</td>
</tr>
<tr>
<td>hasKey</td>
<td align="right">断言Map集合含有此键</td>
<td>assertThat(map, hasKey(“key”));</td>
</tr>
<tr>
<td>hasValue</td>
<td align="right">断言Map集合含有此值</td>
<td>assertThat(map, hasValue(value));</td>
</tr>
<tr>
<td>hasItem</td>
<td align="right">断言迭代对象含有此元素</td>
<td>assertThat(list, hasItem(element));</td>
</tr>
</tbody></table>
<p>下图为使用assertThat测试失败时所显示的具体错误信息。可以看到错误信息很详细！</p>
<p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest07.jpg"></p>
<p>当然了匹配器也是可以自定义的。这里我自定义一个字符串是否是手机号码的匹配器来演示一下。</p>
<p>只需要继承BaseMatcher抽象类，实现matches与describeTo方法。代码如下：</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IsMobilePhoneMatcher</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseMatcher</span>&lt;<span class="hljs-title">String</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 进行断言判定，返回true则断言成功，否则断言失败</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-function"><span class="hljs-title">matches</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span> item</span>)</span> &#123;<br>        <span class="hljs-keyword">if</span> (item == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br><br>        Pattern pattern = Pattern.compile(<span class="hljs-string">&quot;(1|861)(3|5|7|8)\\d&#123;9&#125;$*&quot;</span>);<br>        Matcher matcher = pattern.matcher((<span class="hljs-built_in">String</span>) item);<br><br>        <span class="hljs-keyword">return</span> matcher.find();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 给期待断言成功的对象增加描述</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-function"><span class="hljs-title">describeTo</span>(<span class="hljs-params">Description description</span>)</span> &#123;<br>        description.appendText(<span class="hljs-string">&quot;预计此字符串是手机号码！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 给断言失败的对象增加描述</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-function"><span class="hljs-title">describeMismatch</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span> item, Description description</span>)</span> &#123;<br>        description.appendText(item.toString() + <span class="hljs-string">&quot;不是手机号码！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>执行单元测试如下：</p>
<p>正确的手机号码测试成功：</p>
<p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest08.jpg"></p>
<p>错误号码测试失败：</p>
<p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest09.jpg"></p>
<h4 id="5-Rule用法"><a href="#5-Rule用法" class="headerlink" title="5.@Rule用法"></a>5.@Rule用法</h4><p>还记得一开始我们在@Before与@After注解的方法中加入”测试开始”的提示信息吗？假如我们一直需要这样的提示，那是不是需要每次在测试类中去实现它。这样就会比较麻烦。这时你就可以使用@Rule来解决这个问题，它甚至比@Before与@After还要强大。</p>
<p>自定义@Rule很简单，就是实现TestRule 接口，实现apply方法。代码如下：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> MyRule <span class="hljs-keyword">implements</span> TestRule &#123;<br><br>    @Override<br>    <span class="hljs-keyword">public</span> Statement apply(<span class="hljs-keyword">final</span> Statement base, <span class="hljs-keyword">final</span> <span class="hljs-keyword">Description</span> <span class="hljs-keyword">description</span>) &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Statement() &#123;<br>            @Override<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> evaluate() <span class="hljs-keyword">throws</span> Throwable &#123;<br>                <span class="hljs-comment">// evaluate前执行方法相当于@Before</span><br>                String methodName = <span class="hljs-keyword">description</span>.getMethodName(); <span class="hljs-comment">// 获取测试方法的名字</span><br>                System.out.<span class="hljs-keyword">println</span>(methodName + <span class="hljs-string">&quot;测试开始！&quot;</span>);<br><br>                base.evaluate();  <span class="hljs-comment">// 运行的测试方法</span><br><br>                <span class="hljs-comment">// evaluate后执行方法相当于@After</span><br>                System.out.<span class="hljs-keyword">println</span>(methodName + <span class="hljs-string">&quot;测试结束！&quot;</span>);<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们使用一下我们自定义的MyRule，效果如图：</p>
<p><img src="https://gitee.com/psycho1900/miss-reddle/raw/master/OneNet_APP/AndroidTest10.jpg"></p>
<p>在新建项目的时候，就选择 other==&gt;Anroid Test Project==&gt; 这样就不用配置这些一大堆烦人AndroidManifest.xml了</p>

    </div>
</div>
<style>
    #noneimg img {
        display: none;
        z-index: 109;
        width: 600px !important;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            width: 88%
        }
    }
</style>
<script>
    $(function () { $('#article').click(function (e) { if (e.target.tagName == "IMG") { if ($('#nonediv').length == 0) { let MImg = `<div id='noneimg'><img src='${e.target.currentSrc}'></div>`; let MDiv = "<div id='nonediv' style='cursor: pointer;display: none; position: fixed;left: 0;top: 0; right: 0;bottom: 0;background-color: #333;opacity:0.5;z-index: 108;'></div>"; $('#article').append(MDiv); $('#article').append(MImg); $("#nonediv").fadeIn("slow"); $("#noneimg img").fadeIn("slow") } } else { if ($('#nonediv').length !== 0) { $("#noneimg ").fadeOut("slow"); $("#nonediv").fadeOut("slow"); setTimeout(function () { $('#nonediv').remove(); $('#noneimg').remove() }, 500) } } }); $('.article-content').addClass('content-move') });
</script>
<div class="Last-Next">
    
    <a href="/2021/05/14/Body-Senser-APP/">
        <div class="last">
            <span>上一篇</span>
            <p>Body Senser APP</p>
        </div>
    </a>
    

    
    <a href="/2021/05/12/AD7747-CC2530/">
        <div class="next">
            <span>下一篇</span>
            <p>AD7747_CC2530</p>
        </div>
    </a>
    
</div>
		
<link rel="stylesheet" href="/css/food.css">

<div class="footer">
	<div class="Copyright">
		©2021 By CHANGEQ. 主题：<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/qiaobug/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/qiaobug">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
		</a>
		
	</div>
</div>

<script src="/js/jquery.min.js"></script>


<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: block;
            border-radius: 50%;
            width: 66px;
            height: 66px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            border: 1px solid rgba(18, 24, 58, 0.06);

            transition: border .5s;
            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari 和 Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 30px;
            height: 30px;
            margin-top: 17.5px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $('#js-go_top').gotoTop({ offset: 500, speed: 300, animationShow: { 'transform': 'translate(0,0)', 'transition': 'transform .5s ease-in-out' }, animationHide: { 'transform': 'translate(100px,0)', 'transition': 'transform .5s ease-in-out' } });
</script>
<script>
	console.log('\n %c Hexo-Quiet 主题 %c https://github.com/QiaoBug/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>

</html>